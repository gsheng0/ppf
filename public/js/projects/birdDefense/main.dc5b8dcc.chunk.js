(this["webpackJsonppaint-exp"]=this["webpackJsonppaint-exp"]||[]).push([[0],[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.r(t),n.d(t,"setRoomCode",(function(){return ue})),n.d(t,"setHost",(function(){return ce})),n.d(t,"getIsHost",(function(){return he})),n.d(t,"setScreenNum",(function(){return le})),n.d(t,"setOtherPlayer",(function(){return de})),n.d(t,"setName",(function(){return fe})),n.d(t,"setBirdPlayer",(function(){return ge})),n.d(t,"setBatPlayer",(function(){return ve})),n.d(t,"getOtherPlayer",(function(){return ye})),n.d(t,"swapSides",(function(){return me})),n.d(t,"getMapInstance",(function(){return pe})),n.d(t,"getBatPlayer",(function(){return ke})),n.d(t,"getBirdPlayer",(function(){return we})),n.d(t,"setIsRequest",(function(){return Ee})),n.d(t,"getIsRequest",(function(){return Ae})),n.d(t,"getClickChangeSides",(function(){return Se})),n.d(t,"getClickRequestChangeSides",(function(){return Ce}));var a=function(){function e(){i(this,e),this.birds=[],this.enemies=[],this.projectiles=[],this.factories=[],this.shouldRemoveProjectiles=[],this.nest=void 0,this.player=void 0}return r(e,[{key:"getNest",value:function(){return this.nest}},{key:"getPlayer",value:function(){return this.player}},{key:"setPlayer",value:function(e){this.player=e}},{key:"setNest",value:function(e){this.nest=e}},{key:"addEnemy",value:function(e){this.enemies.push(e)}},{key:"addBird",value:function(e){this.birds.push(e)}},{key:"addFactory",value:function(e){this.factories.push(e)}},{key:"addProjectile",value:function(e){this.projectiles.push(e)}},{key:"simulate",value:function(){this.enemies.forEach((function(e){e.exist()})),this.birds.forEach((function(e){e.exist()})),this.projectiles.forEach((function(e){e.exist()}))}},{key:"clear",value:function(){this.birds=[],this.enemies=[],this.projectiles=[],this.factories=[],this.shouldRemoveProjectiles=[]}},{key:"removeBird",value:function(e){this.birds=this.birds.filter((function(t){return t!==e}))}},{key:"removeEnemy",value:function(e){this.enemies=this.enemies.filter((function(t){return t!==e}))}},{key:"removeProjectile",value:function(e){this.projectiles=this.projectiles.filter((function(t){return t!==e}))}},{key:"removeFactory",value:function(e){this.factories=this.factories.filter((function(t){return t!==e}))}}]),e}(),s=function(){function e(t,n){i(this,e),this.x=t,this.y=n}return r(e,[{key:"getAngleTo",value:function(e){var t=e.x,n=e.y,i=Math.atan2(n-this.y,t-this.x)*(180/Math.PI);return(i=360-i)>=360&&(i-=360),i}},{key:"distanceFrom",value:function(e){var t=e.x,n=e.y;return Math.sqrt(Math.pow(this.x-t,2)+Math.pow(this.y-n,2))}},{key:"toString",value:function(){return"["+this.x+", "+this.y+"]"}},{key:"copy",value:function(){return new e(this.x,this.y)}}]),e}(),u=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Guest";i(this,e),this.id=t,this.name=n,this.money=300}return r(e,[{key:"getId",value:function(){return this.id}},{key:"getName",value:function(){return this.name}},{key:"getMoney",value:function(){return this.money}},{key:"toString",value:function(){return"Name: "+this.name+" id: "+this.id}},{key:"removeMoney",value:function(e){this.money-=e}}]),e}(),c=function(){function e(){i(this,e)}return r(e,null,[{key:"withinBounds",value:function(e,t,n){return e>=t&&e<=n}},{key:"withinBoundsCoords",value:function(e,t,n){return this.withinBounds(e.x,t.x,n.x)&&this.withinBounds(e.y,t.y,n.y)}},{key:"withinBoundsRect",value:function(t,n,i,o,r){return e.withinBoundsCoords(t,new s(n,i),new s(n+o,i+r))}},{key:"loadImages",value:function(){var t="imageBirdDefense/",n=new Image;n.src=t+"chicken.png";var i=new Image;i.loading="eager",i.src=t+"bat.png";var o=new Image;o.loading="eager",o.src=t+"crow.png";var r=new Image;r.loading="eager",r.src=t+"egg.png";var a=new Image;a.loading="eager",a.src=t+"nest.png";var s=new Image;s.loading="eager",s.src=t+"rock.png";var u=new Image;u.loading="eager",u.src=t+"woodpecker.png";var c=new Image;c.loading="eager",c.src=t+"bird_defense.png",e.IMAGES.CHICKEN=n,e.IMAGES.BAT=i,e.IMAGES.CROW=o,e.IMAGES.EGG=r,e.IMAGES.NEST=a,e.IMAGES.ROCK=s,e.IMAGES.WOODPECKER=u,e.IMAGES.NEST=a,e.IMAGES.TITLE=c}},{key:"xRotationShift",value:function(e){return.75*Math.sin(e-Math.PI/4)+.5}},{key:"yRotationShift",value:function(e){return.75*Math.sin(e-3*Math.PI/4)+.5}},{key:"draw",value:function(t,n,i,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.width,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:t.height,s=e.ctx,u=(o=-1*o+90)*Math.PI/180;s.save(),s.translate(n,i),s.translate(e.xRotationShift(u)*r,e.yRotationShift(u)*a),s.rotate(u);try{s.drawImage(t,0,0,r,a)}catch(c){console.log(c)}s.restore()}},{key:"setContext",value:function(e){this.ctx=e}},{key:"fillRect",value:function(t,n,i,o,r){var a=e.ctx;a.beginPath(),a.fillStyle=r,a.rect(t,n,i,o),a.fill(),a.closePath()}},{key:"strokeRect",value:function(t,n,i,o,r){var a=e.ctx;a.beginPath(),a.strokeStyle=r,a.rect(t,n,i,o),a.stroke(),a.closePath()}},{key:"strokeCircle",value:function(t,n,i,o){var r=e.ctx;r.beginPath(),r.strokeStyle=o,r.arc(t,n,i,0,2*Math.PI),r.stroke(),r.closePath()}},{key:"sleep",value:function(e){for(var t=(new Date).getTime();t+e>=(new Date).getTime(););}},{key:"random",value:function(e,t){return Math.floor(Math.random()*(t-e)+e)}},{key:"request",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,o=new XMLHttpRequest;o.open(t,"https://service.gsheng.me:8443/bird/"+e),o.setRequestHeader("Content-Type","application/json"),void 0!==n?o.send(n):o.send(),void 0!==i&&(o.onload=function(){i(o)})}},{key:"buildAction",value:function(t,n,i,o){return JSON.stringify({type:t,x:n,y:i,frameNumber:o,id:e.USER_ID})}},{key:"place",value:function(t,n,i){var o=e.buildAction(t,n.x,n.y,i);e.request("send","POST",o,(function(e){console.log("recieved")}))}},{key:"getGameId",value:function(){e.request("join","GET",void 0,(function(t){e.USER_ID=t.response,console.log("You are user: "+e.USER_ID),fe("Guest "+e.USER_ID)}))}},{key:"sync",value:function(t){var n=JSON.stringify({id:e.USER_ID,type:"sync request"});e.request("sync","POST",n,(function(e){"[]"!==e.response&&(console.log(JSON.parse(e.response)[0]),t(JSON.parse(e.response)))}))}},{key:"createGameRoom",value:function(t){var n={name:t.getName(),id:t.getId()},i=JSON.stringify({id:e.USER_ID,type:"create request",player:n});e.request("room/create","POST",i,(function(e){var n=JSON.parse(e.response);console.log(n),n.error?(alert(n.errorMessage),le(0)):(ue(n.code),ce(!0),ge(t))}))}},{key:"joinGameRoom",value:function(t,n){var i={name:n.getName(),id:n.getId()},o=JSON.stringify({id:e.USER_ID,type:"join room request",code:t,player:i});e.request("room/join","POST",o,(function(e){var t=JSON.parse(e.response);console.log(t),t.error?(alert(t.errorMessage),le(0)):(de(new u(t.otherPlayer.id,t.otherPlayer.name)),console.log(ye().toString()),"bird"===t.side?(ge(ye()),ve(n)):(ve(ye()),ge(n)))}))}},{key:"syncRoom",value:function(t,n,i){var o={name:n.getName(),id:n.getId()},r=JSON.stringify({id:e.USER_ID,type:"sync room request",code:t,player:o,start:i});e.request("room/sync","POST",r,(function(e){var t=JSON.parse(e.response);t.error&&alert(t.errorMessage),t.other&&(de(new u(t.player.id,t.player.name)),"bat"===t.side?void 0===ke()?ve(ye()):ke().getId()!==ye().getId()&&(me(),Ee(!1)):void 0===we()?ge(ye()):we().getId()!==ye().getId()&&(me(),Ee(!1)),t.changeSideRequest&&Ee(!0),t.start&&le(2))}))}},{key:"changeSide",value:function(t,n){var i=JSON.stringify({id:e.USER_ID,type:"change side request",roomCode:t,isFromHost:n});e.request("room/change","POST",i,(function(e){var t=JSON.parse(e.response);t.error&&alert(t.errorMessage)}))}}]),e}();function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t,n){return(l="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function g(e){return(g="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){return!t||"object"!==g(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return v(this,n)}}c.TOP_LEFT=new s(0,0),c.BOTTOM_RIGHT=new s(1e3,800),c.IMAGES={},c.loaded=!1,c.BLACK="#000000",c.GREEN="#149414",c.RED="#ff0000",c.USER_ID=1,c.FRAME_DELAY=1;var m=function(){function e(t,n,o,r,a,s,u,c,h,l,d){i(this,e),this.map=t,this.health=n,this.armor=o,this.location=r,this.damage=a,this.vision=s,this.attackSpeed=u,this.moveSpeed=c/10,this.size=h,this.maxHealth=n,this.target=t.getNest(),this.image=l,this.money=d,this.angle=this.getCenter().getAngleTo(this.target.getCenter()),this.current=l,this.birdsInVision=[],this.moveComponent=this.setMoveComponent(this.target.getLocation()),this.alive=!0,this.cooldown=0,this.range=5,this.angleChanged=!1}return r(e,[{key:"getCenter",value:function(){return new s(this.location.x+this.size,this.location.y+this.size)}},{key:"getMap",value:function(){return this.map}},{key:"getHealth",value:function(){return this.health}},{key:"getArmor",value:function(){return this.armor}},{key:"getLocation",value:function(){return this.location}},{key:"getDamage",value:function(){return this.damage}},{key:"getVision",value:function(){return this.vision}},{key:"getAttackSpeed",value:function(){return this.attackSpeed}},{key:"getMoveSpeed",value:function(){return this.moveSpeed}},{key:"getSize",value:function(){return this.size}},{key:"getMaxHealth",value:function(){return this.maxHealth}},{key:"getTarget",value:function(){return this.target}},{key:"getImage",value:function(){return this.image}},{key:"getMoney",value:function(){return this.money}},{key:"getAngle",value:function(){return this.angle}},{key:"draw",value:function(){this.angleChanged}},{key:"inVision",value:function(e){return this.getCenter().distanceFrom(e.getCenter())-(this.size+e.getSize())<=this.vision}},{key:"canAttack",value:function(e){return this.getCenter().distanceFrom(e.getCenter())-(this.size+e.getSize())<=this.range}},{key:"updateBirdsInVision",value:function(){var e=this;this.birdsInVision=this.map.birds.filter((function(t){return e.inVision(t)}))}},{key:"setMoveComponent",value:function(e){var t=this.getCenter().distanceFrom(e)/this.moveSpeed,n=e.x-this.location.x,i=e.y-this.location.y;this.moveComponent=new s(n/t,i/t)}},{key:"updateTarget",value:function(){var e=this.target;if(this.updateBirdsInVision(),this.target=this.getMap().getNest(),this.birdsInVision.length>0)for(var t=1e12,n=0;n<this.birdsInVision.length;n++){var i=this.birdsInVision[n],o=i.getLocation().distanceFrom(this.location)-i.getSize();o<t&&(this.target=i,t=o)}this.target!==e&&(this.angle=this.getCenter().getAngleTo(this.target.getCenter()),this.angleChanged=!0),this.setMoveComponent(this.target.getCenter())}},{key:"exist",value:function(){this.angleChanged=!1,this.cooldown--,this.updateTarget(),this.canAttack(this.target)?this.cooldown<=0&&(this.attack(this.target),this.cooldown=this.attackSpeed):(this.location.x+=this.moveComponent.x,this.location.y+=this.moveComponent.y)}},{key:"isAlive",value:function(){return this.alive}},{key:"takeDamage",value:function(e){this.health-=Math.max(e-this.armor,1),this.health<=0&&(this.alive=!1,this.map.removeEnemy(this),this.map.getPlayer().addMoney(this.money))}},{key:"attack",value:function(e){e.takeDamage(this.damage),e.getHealth()<=0&&this.updateTarget()}}]),e}(),p=function(e){f(n,e);var t=y(n);function n(e,o){return i(this,n),t.call(this,e,n.MAX_HEALTH,n.ARMOR,o,n.DAMAGE,n.VISION,n.ATTACK_SPEED,n.MOVE_SPEED,n.SIZE,c.IMAGES.BAT,n.MONEY)}return r(n,[{key:"draw",value:function(){c.draw(c.IMAGES.BAT,this.getLocation().x,this.getLocation().y,this.getAngle())}},{key:"toString",value:function(){return"Bat at "+this.location.toString()}}],[{key:"setMap",value:function(e){n.map=e}},{key:"build",value:function(e){var t=new n(n.map,e);return n.map.addEnemy(t),t}}]),n}(m);p.MAX_HEALTH=100,p.ARMOR=2,p.DAMAGE=3,p.VISION=275,p.ATTACK_SPEED=1,p.MOVE_SPEED=20,p.SIZE=8,p.MONEY=7,p.map=void 0;var k=function(e){f(n,e);var t=y(n);function n(e,o){return i(this,n),t.call(this,e,n.MAX_HEALTH,n.ARMOR,o,n.DAMAGE,n.VISION,n.ATTACK_SPEED,n.MOVE_SPEED,n.SIZE,c.IMAGES.BAT,n.MONEY)}return r(n,[{key:"takeDamage",value:function(e){if(l(h(n.prototype),"takeDamage",this).call(this,e),this.getHealth()<=0)for(var t=0;t<15;t++)p.build(new s(this.getCenter().x+(Math.floor(41*Math.random())+20)),this.getCenter().y+Math.floor(41*Math.random()-20))}},{key:"draw",value:function(){c.draw(c.IMAGES.BAT,this.location.x,this.location.y,this.getAngle(),200,100)}},{key:"toString",value:function(){return"Massive Bat at "+this.location.toString()}}],[{key:"setMap",value:function(e){this.map=e}},{key:"build",value:function(e){var t=new n(n.map,e);return n.map.addEnemy(t),t}}]),n}(m);k.MAX_HEALTH=2500,k.ARMOR=20,k.DAMAGE=99,k.VISION=250,k.ATTACK_SPEED=250,k.MOVE_SPEED=.12,k.SIZE=40,k.MONEY=10,k.map=void 0;var w=function(){function e(t,n,o,r,a){i(this,e),this.map=t,this.location=r,this.health=n,this.armor=o,this.size=a,this.alive=!0}return r(e,[{key:"getMap",value:function(){return this.map}},{key:"getLocation",value:function(){return this.location}},{key:"getHealth",value:function(){return this.health}},{key:"getArmor",value:function(){return this.armor}},{key:"getSize",value:function(){return this.size}},{key:"isAlive",value:function(){return this.alive}},{key:"getCenter",value:function(){return new s(this.location.x+this.size,this.location.y+this.size)}},{key:"takeDamage",value:function(e){e=Math.max(e-this.armor,1),this.health-=e,this.health<=0&&(this.map.removeBird(this),this.alive=!1)}}]),e}(),E=function(e){f(n,e);var t=y(n);function n(e,o,r,a,s,u,c,h,l){var d;return i(this,n),(d=t.call(this,e,o,r,a,s)).damage=u,d.range=c,d.attackSpeed=10*h,d.image=l,d.maxHealth=o,d.current=l,d.angleChanged=!1,d.enemiesInRange=[],d.angle=90,d.target=void 0,d.cooldown=0,d}return r(n,[{key:"getLocation",value:function(){return this.location}},{key:"getMap",value:function(){return this.map}},{key:"getDamage",value:function(){return this.damage}},{key:"getRange",value:function(){return this.range}},{key:"getAttackSpeed",value:function(){return this.attackSpeed}},{key:"getImage",value:function(){return this.image}},{key:"getMaxHealth",value:function(){return this.maxHealth}},{key:"getCurrentImage",value:function(){return this.current}},{key:"getAngleChanged",value:function(){return this.angleChanged}},{key:"getEnemiesInRange",value:function(){return this.enemiesInRange}},{key:"getAngle",value:function(){return this.angle}},{key:"getTarget",value:function(){return this.target}},{key:"getCooldown",value:function(){return this.cooldown}},{key:"draw",value:function(){this.angleChanged}},{key:"attack",value:function(e){e.takeDamage(this.damage),e.alive||(this.target=void 0)}},{key:"updateEnemiesInRange",value:function(){var e=this;this.enemiesInRange=this.map.enemies.filter((function(t){return e.inRange(t)}))}},{key:"inRange",value:function(e){return this.getCenter().distanceFrom(e.getCenter())-(this.getSize()+e.getSize())<=this.range}},{key:"updateTarget",value:function(){var e=this.target;if(void 0!==this.target&&this.target.getHealth()<=0&&(this.target=void 0),this.updateEnemiesInRange(),this.inRange.length<1)this.target=void 0;else{for(var t=1/0,n=0;n<this.enemiesInRange.length;n++){var i=this.enemiesInRange[n],o=i.getLocation().distanceFrom(this.getLocation());o<t&&(t=o,this.target=i)}void 0!==this.target&&e!==this.target&&(this.angleChanged=!0,this.angle=this.getCenter().getAngleTo(this.target.getCenter()))}}},{key:"exist",value:function(){this.angleChanged=!1,this.updateTarget(),this.cooldown<=0?void 0!==this.target&&(this.attack(this.target),this.cooldown=this.attackSpeed):this.cooldown--}}]),n}(w),A=function(){function e(t,n,o,r,a,s){i(this,e),this.map=t,this.location=n,this.stepVector=o,this.damage=r,this.radius=a,this.image=s,this.shouldRemove=!1}return r(e,[{key:"draw",value:function(){}},{key:"getMap",value:function(){return this.map}},{key:"getLocation",value:function(){return this.location}},{key:"getStepVector",value:function(){return this.stepVector}},{key:"getDamage",value:function(){return this.damage}},{key:"getRadius",value:function(){return this.radius}},{key:"getImage",value:function(){return this.image}},{key:"getCenter",value:function(){return new s(this.location.x+this.radius,this.location.y+this.radius)}},{key:"inContact",value:function(e){return e.getCenter().distanceFrom(this.getCenter())-(e.getSize()+this.radius)<=this.radius/2}},{key:"exist",value:function(){var e=this,t=this.map.enemies.filter((function(t){return e.inContact(t)}));0===t.length?(this.location.x+=this.stepVector.x,this.location.y+=this.stepVector.y,c.withinBoundsCoords(this.location,c.TOP_LEFT,c.BOTTOM_RIGHT)||this.map.removeProjectile(this)):(t.forEach((function(t){t.takeDamage(e.damage)})),this.map.removeProjectile(this))}}]),e}(),S=function(e){f(n,e);var t=y(n);function n(e,o,r){var a;return i(this,n),(a=t.call(this,e,o,r,66,18,c.EGG)).counter=0,a}return r(n,[{key:"draw",value:function(){this.counter+=10,c.draw(c.IMAGES.EGG,this.getLocation().x,this.getLocation().y,this.counter)}}]),n}(A),C=function(e){f(n,e);var t=y(n);function n(e,o){return i(this,n),t.call(this,e,n.MAX_HEALTH,n.ARMOR,o,n.SIZE,n.DAMAGE,n.RANGE,n.ATTACK_SPEED,c.CHICKEN)}return r(n,[{key:"attack",value:function(e){var t=this.getCenter().distanceFrom(e.getCenter())/5,n=e.getCenter().x-this.getCenter().x,i=e.getCenter().y-this.getCenter().y;this.map.addProjectile(new S(this.map,this.getCenter().copy(),new s(n/t,i/t)))}},{key:"draw",value:function(){c.draw(c.IMAGES.CHICKEN,this.getLocation().x,this.getLocation().y,this.getAngle(),85,85),c.fillRect(this.getLocation().x+5,this.getLocation().y-10,95,10,c.RED),c.fillRect(this.getLocation().x+5,this.getLocation().y-10,95*this.getHealth()/n.MAX_HEALTH,10,c.GREEN),c.strokeRect(this.getLocation().x+5,this.getLocation().y-10,95,10,c.BLACK)}}],[{key:"setMap",value:function(e){this.map=e}},{key:"build",value:function(e){var t=new n(this.map,e);return this.map.addBird(t),t}}]),n}(E);C.RANGE=275,C.MAX_HEALTH=100,C.ARMOR=2,C.SIZE=42,C.DAMAGE=33,C.ATTACK_SPEED=2,C.map=void 0;var R=function(e){f(n,e);var t=y(n);function n(e,o,r){var a;return i(this,n),(a=t.call(this,e,o,r,132,20,c.IMAGES.ROCK)).counter=0,a}return r(n,[{key:"draw",value:function(){this.counter+=10,c.draw(c.IMAGES.ROCK,this.getLocation().x,this.getLocation().y,this.counter/10)}}]),n}(A),M=function(e){f(n,e);var t=y(n);function n(e,o){return i(this,n),t.call(this,e,n.MAX_HEALTH,n.ARMOR,o,n.SIZE,n.DAMAGE,n.RANGE,n.ATTACK_SPEED,c.IMAGES.CROW)}return r(n,[{key:"attack",value:function(e){var t=this.getCenter().distanceFrom(e.getCenter())/17,n=e.getCenter().x-this.getCenter().x,i=e.getCenter().y-this.getCenter().y;this.getMap().addProjectile(new R(this.getMap(),this.getCenter().copy(),new s(n/t,i/t)))}},{key:"draw",value:function(){c.draw(c.IMAGES.CROW,this.getLocation().x,this.getLocation().y,this.getAngle(),85,85),c.fillRect(this.getLocation().x+5,this.getLocation().y-10,95,10,c.RED),c.fillRect(this.getLocation().x+5,this.getLocation().y-10,95*this.getHealth()/n.MAX_HEALTH,10,c.GREEN),c.strokeRect(this.getLocation().x+5,this.getLocation().y-10,95,10,c.BLACK)}}],[{key:"setMap",value:function(e){this.map=e}},{key:"build",value:function(e){var t=new n(this.map,e);return this.map.addBird(t),t}}]),n}(E);M.MAX_HEALTH=150,M.ARMOR=5,M.SIZE=15,M.DAMAGE=66,M.RANGE=150,M.ATTACK_SPEED=2,M.map=void 0;var x=function(e){f(n,e);var t=y(n);function n(e,o,r){var a;return i(this,n),(a=t.call(this,e,o,r,250,30,c.IMAGES.EGG)).counter=0,a}return r(n,[{key:"draw",value:function(){this.counter+=20,c.draw(c.IMAGES.EGG,this.location.x,this.location.y,.3*this.counter,104,104)}},{key:"exist",value:function(){var e=this,t=this.map.enemies.filter((function(t){return e.inContact(t)}));0===t.length?(this.location.x+=this.stepVector.x,this.location.y+=this.stepVector.y,c.withinBoundsCoords(this.location,c.TOP_LEFT,c.BOTTOM_RIGHT)||this.map.removeProjectile(this)):t.forEach((function(t){t.takeDamage(e.damage)}))}}]),n}(A),I=function(e){f(n,e);var t=y(n);function n(e,o){return i(this,n),t.call(this,e,n.MAX_HEALTH,n.ARMOR,o,n.SIZE,n.DAMAGE,n.RANGE,n.ATTACK_SPEED,c.IMAGES.CHICKEN)}return r(n,[{key:"attack",value:function(e){var t=this.getCenter().distanceFrom(e.getCenter())/5,n=e.getCenter().x-this.getCenter().x,i=e.getCenter().y-this.getCenter().y;this.getMap().addProjectile(new x(this.getMap(),this.getCenter().copy(),new s(n/t,i/t)))}},{key:"draw",value:function(){c.draw(c.IMAGES.CHICKEN,this.getLocation().x,this.getLocation().y,this.getAngle(),204,204),c.fillRect(this.getLocation().x+5,this.getLocation().y-10,214,10,c.RED),c.fillRect(this.getLocation().x+5,this.getLocation().y-10,214*this.getHealth()/n.MAX_HEALTH,10,c.GREEN),c.strokeRect(this.getLocation().x+5,this.getLocation().y-10,214,10,c.BLACK)}}],[{key:"setMap",value:function(e){this.map=e}},{key:"build",value:function(e){var t=new n(this.map,e);return this.map.addBird(t),t}}]),n}(E);I.MAX_HEALTH=2500,I.ARMOR=5,I.SIZE=60,I.DAMAGE=200,I.RANGE=400,I.ATTACK_SPEED=5,I.map=void 0;var T=function(e){f(n,e);var t=y(n);function n(e,o){var r;return i(this,n),(r=t.call(this,e,n.MAX_HEALTH,n.ARMOR,o,n.SIZE,n.DAMAGE,n.RANGE,n.ATTACK_SPEED,c.IMAGES.Woodpecker)).counter=0,r}return r(n,[{key:"attack",value:function(e){e.takeDamage(this.damage)}},{key:"draw",value:function(){c.draw(c.IMAGES.WOODPECKER,this.getLocation().x,this.getLocation().y,this.getAngle(),85,85),c.fillRect(this.getLocation().x+5,this.getLocation().y-10,95,10,c.RED),c.fillRect(this.getLocation().x+5,this.getLocation().y-10,95*this.getHealth()/n.MAX_HEALTH,10,c.GREEN),c.strokeRect(this.getLocation().x+5,this.getLocation().y-10,95,10,c.BLACK)}}],[{key:"setMap",value:function(e){this.map=e}},{key:"build",value:function(e){var t=new n(n.map,e);return n.map.addBird(t),t}}]),n}(E);T.MAX_HEALTH=500,T.ARMOR=7,T.SIZE=13,T.DAMAGE=35,T.RANGE=25,T.ATTACK_SPEED=1,T.map=void 0;var L=function(e){f(n,e);var t=y(n);function n(e,o){return i(this,n),t.call(this,e,n.MAX_HEALTH,n.ARMOR,o,n.SIZE)}return r(n,[{key:"draw",value:function(){c.ctx.drawImage(c.IMAGES.NEST,this.getLocation().x,this.getLocation().y),c.fillRect(this.getLocation().x-5,this.getLocation().y+15,2*this.getSize()+10,20,c.RED),c.fillRect(this.getLocation().x-5,this.getLocation().y+15,(2*this.getSize()+10)*(this.getHealth()/2500),20,c.GREEN),c.strokeRect(this.getLocation().x-5,this.getLocation().y+15,2*this.getSize()+10,20,c.BLACK)}},{key:"toString",value:function(){return"Nest at "+this.location.toString()}},{key:"takeDamage",value:function(e){e=Math.max(e-this.armor,1),this.health-=e,this.health<=0&&(this.alive=!1)}}]),n}(w);L.MAX_HEALTH=2500,L.ARMOR=4,L.SIZE=135;var G=function(){function e(t,n,o,r){i(this,e),this.map=t,this.location=n,this.spawnRate=o,this.product=r,this.cooldown=o}return r(e,[{key:"getLocation",value:function(){return this.location}},{key:"getMap",value:function(){return this.map}},{key:"getProduct",value:function(){return this.product}},{key:"exist",value:function(){this.cooldown<=0?(this.product===p?p.build(this.location.copy()):this.product===k&&k.build(this.location.copy()),this.cooldown=this.spawnRate):this.cooldown--}}]),e}(),B=function(e){f(n,e);var t=y(n);function n(e,o){return i(this,n),t.call(this,e,o,500,k)}return r(n,[{key:"draw",value:function(){c.fillRect(this.getLocation().x,this.getLocation().y,100,100,c.BLACK)}}],[{key:"setMap",value:function(e){n.map=e}},{key:"build",value:function(e){var t=new n(n.map,e);return n.map.addFactory(t),t}}]),n}(G);B.map=void 0;var O=function(e){f(n,e);var t=y(n);function n(e,o){return i(this,n),t.call(this,e,o,150,p)}return r(n,[{key:"draw",value:function(){c.fillRect(this.getLocation().x,this.getLocation().y,50,50,c.BLACK)}}],[{key:"setMap",value:function(e){n.map=e}},{key:"build",value:function(e){var t=new n(n.map,e);return this.map.addFactory(t),t}}]),n}(G);O.map=void 0;var b,P,H,D,K,N,_,j=function(e){for(var t=0;t<e.length;t++){var n=e[t];"chicken"===n.type?C.build(new s(n.x,n.y)):"massivechicken"===n.type?I.build(new s(n.x,n.y)):"crow"===n.type?M.build(new s(n.x,n.y)):"woodpecker"===n.type?T.build(new s(n.x,n.y)):"batfactory"===n.type?O.build(new s(n.x,n.y)):"massivebatfactory"===n.type?B.build(new s(n.x,n.y)):console.log("Invalid type: "+n.type)}},V=new s(0,0),q=!1,z=void 0,F=0,X=!1,U=!1,J=!1,Z=!1,W="Guest",$="Start",Y="",Q=void 0,ee=!1,te=!1,ne=!1;function ie(){var e;b=document.getElementById("myCanvas"),P=b.getContext("2d"),H=new a,K=new L(H,new s(350,250)),D=new u(-1),N=D,H.nest=K,c.setContext(P),c.loadImages(),P.font="50px serif",c.getGameId(),e=b,document.addEventListener("pointermove",(function(t){var n=t.clientX-e.offsetLeft,i=t.clientY-e.offsetTop;if(V=new s(n,i),0===F){var o=function(e,t,n){var i=c.ctx,o=i.measureText(e),r=new s(t.width/2-o.width/2-25,t.height/2+50),a=new s(r.x+o.width+50,r.y+50),u=c.withinBoundsCoords(n,r,a),h=i.measureText("Single Player");return r=new s(t.width/2-h.width/2-25,t.height/2+170),a=new s(r.x+o.width+50,r.y+50),{hoverStart:u,hoverSinglePlayer:c.withinBoundsCoords(n,r,a)}}($,e,V);X=o.hoverStart,ee=o.hoverSinglePlayer,(X||ee)&&(Z=!1,J=!1)}else 3===F&&(U=function(e,t){var n=c.ctx.measureText("Ok"),i=new s(e.width/2-n.width/2-50,e.height/2-50),o=new s(i.x+n.width+100,i.y+150);return c.withinBoundsCoords(t,i,o)}(e,V))})),e.addEventListener("pointerdown",(function(e){if(console.log("mouse down"),1===F)!function(e,t){console.log("HERE");var n=c.ctx,i="";i=he()?"Change Sides":"Request Change Sides";var o=n.measureText(i),r=new s(650,450),a=new s(700+o.width+50,525);c.withinBoundsCoords(e,r,a)&&c.changeSide(t,he())}(V,Y);else if(2===F){var t=function(e,t){var n=we().id===c.USER_ID;return 0!==e.button?{selection:void 0,pressed:!1}:c.withinBoundsCoords(t,new s(1050,95),new s(1175,230))?n?{selection:C,pressed:!0}:{selection:O,pressed:!0}:c.withinBoundsCoords(t,new s(1225,95),new s(1350,230))?n?{selection:I,pressed:!0}:{selection:B,pressed:!0}:c.withinBoundsCoords(t,new s(1050,325),new s(1175,460))?n?{selection:M,pressed:!0}:{selection:void 0,pressed:!1}:c.withinBoundsCoords(t,new s(1225,325),new s(1350,460))&&n?{selection:T,pressed:!0}:{selection:void 0,pressed:!1}}(e,V);z=t.selection,q=t.pressed}})),document.addEventListener("pointerup",(function(t){if(console.log("mouse up"),0===F){if(0===t.button){var n=function(e,t,n,i,o,r){var a=0,h=c.ctx,l=!1,d=!1;t?(""===n?(n=c.createGameRoom(new u(c.USER_ID,i)),console.log("room code: "+n)):c.joinGameRoom(n,new u(c.USER_ID,i)),a++):r&&(a+=2);var f=h.measureText(i),g=new s(o.width/2-f.width/2-50,o.height/2-190),v=new s(g.x+f.width+100,g.y+50);c.withinBoundsCoords(e,g,v)&&(l=!0,d=!1,t=!1,r=!1);var y=h.measureText("Enter room code: "+n);return g=new s(o.width/2-y.width/2-50,o.height/2-70),v=new s(g.x+y.width+100,g.y+50),c.withinBoundsCoords(e,g,v)&&(d=!0,t=!1,l=!1,r=!1),{clickName:l,clickRoom:d,screen:a}}(V,X,Y,W,e,ee);J=n.clickName,Z=n.clickRoom,F=n.screen}}else 2===F?(function(e,t,n,i,o){if(0===e.button)if(t.x>1e3)i=void 0;else{if(i===C){if(n.getMoney()<100)return void(i=void 0);n.removeMoney(100),C.build(t),c.place("chicken",t,o)}else if(i===I){if(n.getMoney()<750)return void(i=void 0);n.removeMoney(750),I.build(t),c.place("massivechicken")}else if(i===T){if(n.getMoney()<50)return void(i=void 0);n.removeMoney(50),T.build(t),c.place("woodpecker",t,o)}else if(i===M){if(n.getMoney()<200)return void(i=void 0);n.removeMoney(200),M.build(t),c.place("crow",t,o)}else if(i===O){if(n.getMoney()<300)return void(i=void 0);n.removeMoney(300),O.build(t),c.place("batfactory",t,o)}else if(i===B){if(n.getMoney()<1200)return void(i=void 0);n.removeMoney(1200),B.build(t),c.place("massivebatfactory",t,o)}i=void 0}}(t,V,D,z,oe),z=void 0):3===F&&function(e,t,n){0===e.button&&t&&n()}(t,U,se)})),document.addEventListener("keydown",(function(e){if(0===F){if(!J&&!Z)return;J?1===e.key.length?W+=e.key:"Backspace"===e.key&&(W=W.substring(0,W.length-1)):Z&&(1===e.key.length?Y+=e.key:"Backspace"===e.key&&(Y=Y.substring(0,Y.length-1)),$=""!==Y?"Enter Room":"Start")}else 1===F&&c.syncRoom(Y,new u(c.USER_ID,W),!0)})),p.setMap(H),k.setMap(H),C.setMap(H),M.setMap(H),I.setMap(H),T.setMap(H),O.setMap(H),B.setMap(H)}var oe=0;function re(){c.strokeRect(0,0,b.width-400,b.height,c.BLACK),c.fillRect(0,0,b.width-400,b.height,"#87CEEB"),c.strokeRect(0,0,b.width,b.height,c.BLACK),c.sync(j),ee&&oe%100===0&&function(){var e,t,n=c.random(0,4);0===n?(e=c.random(0,1e3),t=0):1===n?(e=0,t=c.random(0,800)):2===n?(e=c.random(0,1e3),t=800):3===n&&(e=1e3,t=c.random(0,800));p.build(new s(e,t))}(),H.nest.draw();for(var e=0;e<H.projectiles.length;e++)try{H.projectiles[e].exist(),H.projectiles[e].draw()}catch(a){console.log(a)}for(var t=0;t<H.birds.length;t++)H.birds[t].exist(),H.birds[t].draw();for(var n=0;n<H.enemies.length;n++)H.enemies[n].exist(),H.enemies[n].draw();for(var i=0;i<H.factories.length;i++)H.factories[i].exist(),H.factories[i].draw();var o,r;N.id===c.USER_ID?function(e,t){var n=c.ctx;c.fillRect(1e3,0,400,800,"#964B00"),c.strokeRect(1020,60,360,205,c.BLACK),c.strokeRect(1050,95,125,135,c.BLACK),c.strokeRect(1225,95,125,135,c.BLACK),c.strokeRect(1020,290,360,205,c.BLACK),c.strokeRect(1050,325,125,135,c.BLACK),c.strokeRect(1225,325,125,135,c.BLACK),c.draw(c.IMAGES.CHICKEN,1075,120,90,85,85),c.draw(c.IMAGES.CHICKEN,1215,105,90,154,154),c.draw(c.IMAGES.CROW,1075,350,90,85,85),c.draw(c.IMAGES.WOODPECKER,1250,350,90,85,85),n.font="20px serif",n.fillStyle=c.BLACK,n.fillText("$100",1090,90),n.fillText("$750",1265,90),n.fillText("$200",1090,320),n.fillText("$50",1270,320),n.fillText("$"+e,1015,25),n.fillText("Health: "+t,1015,45)}(D.getMoney(),K.getHealth()):function(e,t){var n=c.ctx;c.fillRect(1e3,0,400,800,"#964B00"),c.strokeRect(1020,60,360,205,c.BLACK),c.strokeRect(1050,95,125,135,c.BLACK),c.strokeRect(1225,95,125,135,c.BLACK),c.fillRect(1092,137,50,50,c.BLACK),c.fillRect(1237,107,100,100,c.BLACK),n.font="20px serif",n.fillStyle=c.BLACK,n.fillText("$300",1090,90),n.fillText("$1200",1265,90),n.fillText("$"+e,1015,25),n.fillText("Health: "+t,1015,45)}(D.getMoney(),K.getHealth()),q&&void 0!==z&&(r=V,(o=z)===C?(c.draw(c.IMAGES.CHICKEN,r.x,r.y,90,85,85),c.strokeCircle(r.x+42,r.y+42,C.RANGE,c.BLACK)):o===I?(c.draw(c.IMAGES.CHICKEN,r.x,r.y,90,204,204),c.strokeCircle(r.x+102,r.y+102,I.RANGE,c.BLACK)):o===M?(c.draw(c.IMAGES.CROW,r.x,r.y,90,85,85),c.strokeCircle(r.x+42,r.y+42,M.RANGE,c.BLACK)):o===T?(c.draw(c.IMAGES.WOODPECKER,r.x,r.y,90,85,85),c.strokeCircle(r.x+42,r.y+42,T.RANGE,c.BLACK)):o===O?c.fillRect(r.x,r.y,50,50,c.BLACK):o===B&&c.fillRect(r.x,r.y,100,100,c.BLACK)),K.alive||F++,oe++}function ae(){P.clearRect(0,0,b.width,b.height),c.strokeRect(0,0,b.width,b.height,c.BLACK),0===F?function(e,t,n,i,o,r,a,s){var u=c.ctx;u.fillStyle="#87CEEB",u.fillRect(0,0,e.width,e.height);var h=e.width/2-490,l=e.height/2-350;u.drawImage(c.IMAGES.TITLE,h,l),u.fillStyle=c.BLACK,u.font="50px serif";var d=u.measureText("Welcome, "+i),f=u.measureText("Enter room code: "+t),g=u.measureText(n),v=u.measureText("Single Player");u.fillText(n,e.width/2-g.width/2,e.height/2+90),u.fillText("Enter room code: "+t,e.width/2-f.width/2,e.height/2-30),u.fillText("Welcome, "+i,e.width/2-d.width/2,e.height/2-150),u.fillText("Single Player",e.width/2-v.width/2,e.height/2+210),a?(c.draw(c.IMAGES.BAT,e.width/2-g.width/2-50,e.height/2+50,0),c.strokeRect(e.width/2-g.width/2-25,e.height/2+50,g.width+50,50,c.BLACK)):s?(c.draw(c.IMAGES.BAT,e.width/2-g.width/2-133,e.height/2+170,0),c.strokeRect(e.width/2-v.width/2-25,e.height/2+170,v.width+50,50,c.BLACK)):o?c.strokeRect(e.width/2-d.width/2-50,e.height/2-190,d.width+100,50,c.BLACK):r&&c.strokeRect(e.width/2-f.width/2-50,e.height/2-70,f.width+100,50,c.BLACK)}(b,Y,$,W,J,Z,X,ee):1===F?(c.syncRoom(Y,new u(c.USER_ID,W)),function(e,t,n,i){var o=c.ctx;if(o.fillText(e,700,600),o.fillText(n.name,200,200),void 0!==t&&(o.fillText(t.name,1200,200),i.name===t.name?c.draw(c.IMAGES.CHICKEN,1200,100,0,50,50):c.draw(c.IMAGES.BAT,1200,100,0)),i.name===n.name?c.draw(c.IMAGES.CHICKEN,200,100,0,50,50):c.draw(c.IMAGES.BAT,200,100,0),o.fillStyle=c.BLACK,he()){Ae()&&(o.fillStyle=c.RED),o.fillText("Change Sides",700,500),o.fillStyle=c.BLACK;var r=o.measureText("Change Sides");c.strokeRect(650,450,r.width+100,75,c.BLACK),o.fillText("Press any key to start",500,100)}else{o.fillText("Request Change Sides",700,500);var a=o.measureText("Request Change Sides");c.strokeRect(650,450,a.width+100,75,c.BLACK),o.fillText("Press any key to start",500,100)}}(Y,Q,D,N)):2===F?re():3===F&&function(e,t,n){var i=c.ctx;i.fillStyle="#fd5e53",i.fillRect(0,0,n.width,n.height),i.fillStyle=c.BLACK,i.font="50px serif";var o=i.measureText("Ok");i.fillText("Ok",n.width/2-o.width/2,n.height/2+40),e&&(c.draw(c.IMAGES.BAT,n.width/2-o.width/2-50,n.height/2,0),c.strokeRect(n.width/2-o.width/2-50,n.height/2-50,o.width+100,150,c.BLACK));var r=30*t/1e3,a=Math.floor(r/60);r%=60,i.fillText("Survival Time: "+a+":"+r,200,200)}(U,oe,b)}function se(){H.clear(),K.health=2500,D.money=300,K.alive=!0,oe=0}window.onload=function(){ie(),setInterval(ae,30)};var ue=function(e){Y=e},ce=function(e){te=e},he=function(){return te},le=function(e){F=e},de=function(e){Q=e},fe=function(e){D.name=e,W=e},ge=function(e){N=e},ve=function(e){_=e},ye=function(){return Q},me=function(){var e=N;N=_,_=e},pe=function(){return H},ke=function(){return _},we=function(){return N},Ee=function(e){ne=e},Ae=function(){return ne},Se=function(){return false},Ce=function(){return false}}],[[0,1]]]);
//# sourceMappingURL=main.dc5b8dcc.chunk.js.map